@model IEnumerable<BJProduction.Models.Production_Indent>

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/index.cshtml";
}

<head>
    <style type="text/css">
        th, td { white-space: nowrap; }
        div.dataTables_wrapper {
            width: 100%;
            margin: 0 auto;
        }
    </style>
</head>

<div class="main-card mb-3 card">
@if (Request.IsAuthenticated && User.IsInRole("Create"))
{
    <div class="card-header-tab card-header">
        <div class="card-header-title font-size-lg text-capitalize font-weight-normal"><i class="header-icon lnr-laptop-phone mr-3 text-muted opacity-6"> </i>Production Indent</div>
        <div class="btn-actions-pane-right actions-icon-btn">
            @Html.ActionLink("Create New", "Create", null, new { @class = "btn-shadow btn btn-info" })

        </div>
    </div>
}
    <div class="card-body">
        <table style="width: 100%;" id="" class="table table-hover table-striped table-bordered Sumon">
            <thead>
            <tr>
                <th>#</th>
                <th>
                    @Html.DisplayNameFor(model => model.indent_no)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Product_Type.type_name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Machine.name)
                </th>

                <th>
                    @Html.DisplayNameFor(model => model.Shift.name)
                </th>

                <th>
                    @Html.DisplayNameFor(model => model.qty)
                </th>
              
                <th>
                    @Html.DisplayNameFor(model => model.prod_count)
                </th>

                <th>
                    @Html.DisplayNameFor(model => model.indent_date)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.shift_start)
                </th>

                <th></th>
            </tr>
            </thead>
            <tbody>
            @{
                int rowNumber = 1;
            }
            @foreach (var item in Model.Where(x => x.status != "C"))
            {
                <tr>
                    <th scope="row">@rowNumber</th>
                    <td>
                        @Html.DisplayFor(modelItem => item.indent_no)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Product_Type.type_name)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Machine.name)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.Shift.name)
                    </td>


                    <td>
                        @Html.DisplayFor(modelItem => item.qty) <span id="Count_@item.id" class=" badge badge-success pull-right" style="position: relative; top:2px"></span>
                    </td>
                  
                    <td>
                        @Html.DisplayFor(modelItem => item.prod_count) <span id="QTY_@item.id" class=" badge badge-success pull-right" style="position: relative; top:2px"></span>
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.indent_date)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.shift_start)
                    </td>

                    <td align="right">
                        @Html.ActionLink("Select", "Edit", new { id = item.id }, new { @class = "mb-2 mr-2 btn btn-sm btn-outline-info" })
                        @*@Html.ActionLink("Close", "Details", new { id = item.id }, new { @class = "mb-2 mr-2 btn btn-sm btn-outline-danger" })*@
                    </td>
                </tr>
                rowNumber++;
            }
            </tbody>
            <tfoot>

            </tfoot>
        </table>
    </div>
</div>
<div class="main-card mb-3 card">
    <div class="card-body">
        <table style="width: 100%;" id="" class="table table-hover table-striped table-bordered Sumon">
            <thead>
                <tr>
                    <th>#</th>
                    <th>
                        @Html.DisplayNameFor(model => model.indent_no)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Product_Type.type_name)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.Machine.name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.Shift.name)
                    </th>

                    <th>
                        @Html.DisplayNameFor(model => model.qty)
                    </th>
                   
                    <th>
                        @Html.DisplayNameFor(model => model.prod_count) 
                    </th>

                    <th>
                    @Html.DisplayNameFor(model => model.indent_date)
                    </th>
                    <th>
                        @Html.DisplayNameFor(model => model.shift_start)
                    </th>

                    <th></th>
                </tr>
            </thead>
            <tbody>
                @{
                    int rowNumberC = 1;
                }
                @foreach (var item in Model.Where(x => x.status == "C"))
                {
                    <tr>
                        <th scope="row">@rowNumberC</th>
                        <td>
                            @Html.DisplayFor(modelItem => item.indent_no)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Product_Type.type_name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Machine.name)
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.Shift.name)
                        </td>


                        <td>
                            @Html.DisplayFor(modelItem => item.qty)  <span id="Count_@item.id" class=" badge badge-light pull-right" style="position: relative; top:2px"></span>
                        </td>
                        
                        <td>
                            @Html.DisplayFor(modelItem => item.prod_count)  <span id="QTY_@item.id" class=" badge badge-light pull-right" style="position: relative; top:2px"></span>
                        </td>

                        <td>
                            @Html.DisplayFor(modelItem => item.indent_date)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.shift_start)
                        </td>

                        <td align="right">
                            @Html.ActionLink("Select", "Edit", new { id = item.id }, new { @class = "mb-2 mr-2 btn btn-sm btn-outline-info" })
                            @*@Html.ActionLink("Close", "Details", new { id = item.id }, new { @class = "mb-2 mr-2 btn btn-sm btn-outline-danger" })*@
                        </td>
                    </tr>
                    rowNumberC++;
                }
            </tbody>
            <tfoot>

            </tfoot>
        </table>
    </div>
</div>
@section scripts{

    <script type="text/javascript">

        $( document ).ready(function() {

    setTimeout(function () {

        $('.Sumon').DataTable( {

        scrollX:        true,
        scrollCollapse: true,
        paging:         true,
        ordering: false,
        fixedColumns:   true
    } );

        $('#Tito').DataTable({
            scrollY:        '292px',
            scrollCollapse: true,
            paging:         false,
            "searching": false,
            "info": false
        });
        PID()
    }, 200);
        
});

function PID() {
    $.ajax({
        type: "GET",
        url: '@Url.Action("ProducedItemCount", "Production_Indent")',
        contentType: "application/json;charset=utf-8",
        success: function(data) {
        $.each(data,function(key,value){
        $("#QTY_"+value.ProductionIndentId).html(value.ProdCountSum)
        $("#Count_"+value.ProductionIndentId).html(value.ProductCount)
        })
        }
    })
}

    </script>
}